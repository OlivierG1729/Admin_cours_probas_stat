# dossier contenant les revenus du patrimoine calculées dans le programme 05_base_rev_pr_patri.R
dossier_revenus_patrimoine <- "T:/BHD/BHD - Autonomix/Etablissement/Bases/3-Imputations/Module_patrimoine"
# dossier contenant des données sur le lieu de naissance du conjoint
dossier_lieu_naissance_cj <- "T:/BHD/BHD - Enquete CARE/3 Institutions/Bases SAS/3 Bases de travail Drees"
# dossier contenant les données nécesaires à la récupération du FINESS
dossier_recuperation_finess <- "T:/BHD/BHD - Enquete CARE/3 Institutions/Diffusion/CASD non SNDS/suppléments CASD hors SNDS"
# dossier contenant les bases de patrimoine ménages et individus, le montant sur les comptes chèques
dossier_bases <- "//pro075001app366/dreessascommun$/BHD/BHD - Autonomix/Etablissement/Bases/"
# Sauvegarde
save(dossier_sauvegarde_rdata,
chemin_donnees_construites_,
nom_branche,
chemin_constitution,
dossier_data_care_i_deces_actualisees,
dossier_graphiques,
dossier_revenus_imputes_insee,
dossier_data_insee_aspa,
dossier_table_quetelet,
dossier_data_seniors,
dossier_data_cadrage,
dossier_care_i_revenus,
dossier_carei2,
dossier_revenus_patrimoine,
dossier_lieu_naissance_cj,
dossier_recuperation_finess,
dossier_bases,
file = paste0(dossier_sauvegarde_rdata, "/00_data.Rdata"))
########################################################################
#                                                                      #
# Résultats de l'imputation de patrimoine dans CARE-I                  #
#                                                                      #
#  BHD - Olivier Guin                                                  #
#                                                                      #
# Dernière MAJ : 11/03/2024                                            #
########################################################################
rm(list=ls())
library(ggplot2)
library(mice)
library(dplyr)
library(data.table)
library(survey)
library(descr)
library(openxlsx)
library(reldist)
library(stringr)
dossier_load0 <- "C:/Users/olivier.guin/Travail/Autonomix/Travaux/Sujet_grignotage_patrimoine/Code/rdata/rdata_production"
load(paste0(dossier_load0, "/00_data.Rdata"))
load(paste0(dossier_sauvegarde_rdata, "/06_data.RData"))
# sauvegarde des données d'âge d'entrée en établissement complètes (initiales
# et imputées) pour externalisation dans le programme d'imputation de durée
# de vie 04_imputation_temps_survie.R
data_age_entree_etablissement_complete <- base_care_impute_all %>%
rename(idsenior = IDSENIOR, age_entree_complete = AGEQ) %>%
select(idsenior, age_entree_complete)
# Sauvegarde
save(data_age_entree_etablissement_complete,
file = paste0(dossier_sauvegarde_rdata,
"/07_data_age_entree_complete.Rdata")
)
table(data_age_entree_etablissement_complete$age_entree_complete)
# --- PROVISOIRE en attendant l'intégration de base_care et base_patri dans 9_data.Rdata ----
# le but de cette partie (à effacer ensuite) est de reconstruire (partiellement) la table
# base_care de manière à pouvoir commencer l'exploitation des données de patrimoine imputé
# obtenues via le code 9_imputation_patrimoine.R
load(paste0(dossier_revenus_patrimoine,
"/base_rev_patri.RData"))
# on récupère le finess
load(paste0(dossier_recuperation_finess,
"/complement_care_I.RData"))
complement_care_i <- as.data.table(complement_care_i)
complement_care_i <- complement_care_i[,list(IDSENIOR,FINESS,DEP)]
# fusion de dt et complement_care_i : pour récuperer le FINESS
dt <- merge(dt, complement_care_i, all.x=TRUE, by="IDSENIOR")
# construction d'une variable region = "IDF" ou "Autres"
dt[,region:="AUTRES"][DEP %in% c("75","77","78","91","92","93","94","94"),
region:="IDF"]
base_care <- dt
load(paste0(dossier_bases, "/1-Entrees_brutes/patrimoine_menage.RData"))
# table patrimoine ménage
patrimoine_menage <- as.data.table(patrimoine_menage)
# sans les poids
g11 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I),
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids initiaux
g12 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I),
weights=POIDS_SENIOR,
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids calés
g13 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I),
weights=poids_cales,
fill=BASECARE)) +
geom_density(alpha=0.5)
# sans les poids
g21 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I))%>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g23 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g21 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I))%>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g22 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g23 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g21 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I))%>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g22 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g23 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g31 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I))%>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g32 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g33 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=poids_cales))) %>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g41 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I))%>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g42 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g43 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I, w=poids_cales))) %>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g51 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I),
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids initiaux
g52 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I),
weights=POIDS_SENIOR,
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids calés
g53 <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I),
weights=poids_cales,
fill=BASECARE)) +
geom_density(alpha=0.5)
figure <- ggarrange(g1, g2, g3,
labels = c("sans poids", "poids initaux", "poids calés"),
ncol = 2, nrow = 2)
figure <- ggarrange(g51, g52, g53,
labels = c("sans poids", "poids initaux", "poids calés"),
ncol = 2, nrow = 2)
figure
# sans les poids
g61 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I))%>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g62 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g63 <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g71 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I))%>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g72 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g73 <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=poids_cales))) %>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g81 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I))%>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g82 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=POIDS_SENIOR))) %>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g83 <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I, w=poids_cales))) %>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g11c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I_dupliquee),
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids initiaux
g12c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I_dupliquee),
weights=POIDS_SENIOR,
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids calés
g13c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATIMM_I_dupliquee),
weights=poids_cales,
fill=BASECARE)) +
geom_density(alpha=0.5)
# sans les poids
g21c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I_dupliquee))%>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g22c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g23c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g31c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I_dupliquee))%>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g32c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g33c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=RFONC, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g41c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy=mean(moy10_PATIMM_I_dupliquee))%>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g42c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g43c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATIMM_moy= (weighted.mean(moy10_PATIMM_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=CSP_8, y=PATIMM_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g51c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I_dupliquee),
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids initiaux
g52c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I_dupliquee),
weights=POIDS_SENIOR,
fill=BASECARE)) +
geom_density(alpha=0.5)
# avec poids calés
g53c <- ggplot(base_care_patri_impute_all,
aes(log(moy10_PATFISOM_sans_cc_I_dupliquee),
weights=poids_cales,
fill=BASECARE)) +
geom_density(alpha=0.5)
# sans les poids
g61c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I_dupliquee))%>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g62c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g63c <- base_care_patri_impute_all %>%
group_by(BASECARE, type_menage) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=type_menage, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g71c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I_dupliquee))%>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g72c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g73c <- base_care_patri_impute_all %>%
group_by(BASECARE, RFONC) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=RFONC, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# sans les poids
g81c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy=mean(moy10_PATFISOM_sans_cc_I_dupliquee))%>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids initiaux
g82c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=POIDS_SENIOR))) %>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
# avec poids calés
g83c <- base_care_patri_impute_all %>%
group_by(BASECARE, CSP_8) %>%
mutate(PATFISOM_sans_cc_moy= (weighted.mean(moy10_PATFISOM_sans_cc_I_dupliquee, w=poids_cales))) %>%
ggplot(aes(x=CSP_8, y=PATFISOM_sans_cc_moy, fill=BASECARE)) +
geom_col(position = "dodge")+
theme_bw()+
scale_y_continuous(breaks=seq(0,1000000,50000))
library(ggpubr)
# distribution du patrimoine immobilier par base avec imputation SANS poids calés
figure1c <- ggarrange(g11c, g12c, g13c,
labels = c("sans poids", "poids initaux", "poids calés"),
ncol = 2, nrow = 2)
figure1c
figure <- ggarrange(g1, g2, g3,
labels = c("sans poids", "poids initaux", "poids calés"),
ncol = 2, nrow = 2)
library(dplyr)
library(data.table)
library(rdrees)
library(dplyr)
library(data.table)
# library(rdrees)
library(survey)
library(descr)
#library(Hmisc)
library(openxlsx)
#library(plyr)
library(ggplot2)
# library(scales)
# library(wesanderson)
library(reldist)
# library(cowplot)
library(stringr)
library(knitr)
library(wesanderson)
install.packages("weseanderson")
